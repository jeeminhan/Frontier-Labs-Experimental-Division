---
export const prerender = false;
import '../styles/global.css'
import defaultPrototypes from '../data/prototypes.json'
import { list } from '@vercel/blob'

let prototypes = defaultPrototypes as Record<string, any>;
try {
  const { blobs } = await list({ prefix: 'prototypes.json' });
  if (blobs.length > 0) {
    const res = await fetch(blobs[0].url, { cache: 'no-store' });
    prototypes = await res.json();
  }
} catch {}
const links = prototypes['ism-primer']
const previewUrl = links.prototypeUrl.replace('/view?usp=sharing', '/preview')
---

<html class="light" lang="en">
	<head>
		<meta charset="utf-8" />
		<meta content="width=device-width, initial-scale=1.0" name="viewport" />
		<title>Frontier Labs | ISM Primer</title>
		<meta name="generator" content={Astro.generator} />
		<link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;700;900&display=swap" rel="stylesheet" />
		<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet" />
	</head>
	<body class="bg-background-light dark:bg-background-dark text-stone-900 dark:text-stone-100 min-h-screen">
		<div class="relative flex min-h-screen flex-col overflow-x-hidden">

			<!-- Top Navigation -->
			<header class="sticky top-0 z-50 bg-background-light/95 dark:bg-background-dark/95 border-b-4 border-black backdrop-blur-sm">
				<div class="max-w-[1440px] mx-auto px-4 md:px-6 py-4 flex items-center justify-between">
					<div class="flex items-center gap-4 md:gap-8">
						<a href="/" class="flex items-center gap-2 group cursor-pointer no-underline text-inherit">
							<div class="bg-primary p-1 brutalist-border">
								<span class="material-symbols-outlined text-white text-xl md:text-2xl">terminal</span>
							</div>
							<div><h1 class="text-lg md:text-2xl font-[400] tracking-tighter uppercase italic leading-none">Frontier Labs</h1><p class="text-[8px] md:text-[9px] font-black uppercase tracking-[0.15em] text-stone-400 ml-[2px]">Experimental Division</p></div>
						</a>
					</div>
					<div class="flex items-center gap-2 md:gap-4">
						<a href="/" class="md:hidden text-xs font-black uppercase tracking-widest hover:text-primary no-underline text-inherit">
							Feed
						</a>
						<a href="/connect" class="bg-primary text-white font-black px-4 md:px-6 py-2 brutalist-border shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] md:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all uppercase tracking-tighter no-underline text-xs md:text-base">
							Connect
						</a>
					</div>
				</div>
			</header>

			<main class="flex-1 max-w-[1440px] mx-auto w-full p-6 md:p-10">

				<!-- Page Header -->
				<div class="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-8">
					<div>
						<div class="flex items-center gap-3 mb-2">
							<span class="text-xs font-black text-stone-400">#019</span>
							<span class="bg-blue-100 text-blue-700 px-2 py-0.5 text-[10px] font-black border border-blue-700 uppercase">Document</span>
						</div>
						<h2 class="text-4xl md:text-6xl font-[900] tracking-tighter uppercase leading-none mb-3">
							ISM <span class="text-primary italic">Primer</span>
						</h2>
						<p class="text-base font-medium text-stone-500 max-w-xl">
							International Student Ministry Primer â€” January 2026. Leave comments on the Google Drive version.
						</p>
					</div>
					<a
						href={links.prototypeUrl}
						target="_blank"
						rel="noopener noreferrer"
						class="bg-primary text-black font-black px-8 py-4 brutalist-border shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] hover:shadow-none hover:translate-x-[3px] hover:translate-y-[3px] transition-all uppercase tracking-tighter text-lg no-underline flex items-center gap-2 shrink-0"
					>
						<span class="material-symbols-outlined">comment</span>
						Open in Drive to Comment
					</a>
				</div>

				<!-- Info Banner -->
				<div class="bg-stone-100 dark:bg-stone-800 brutalist-border p-4 mb-6 flex items-center gap-3">
					<span class="material-symbols-outlined text-primary">info</span>
					<p class="text-xs font-bold uppercase tracking-widest text-stone-500">
						To leave comments, open the document in Google Drive. Requires a Google account.
					</p>
				</div>

				<!-- Desktop Monitor Frame -->
				<div class="brutalist-border bg-black overflow-hidden shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]">
					<!-- Window Title Bar -->
					<div class="bg-stone-900 border-b-2 border-black px-4 py-2 flex items-center justify-between">
						<div class="flex items-center gap-3">
							<div class="flex items-center gap-1.5">
								<div class="size-3 rounded-full bg-red-500 border border-red-700"></div>
								<div class="size-3 rounded-full bg-yellow-500 border border-yellow-700"></div>
								<div class="size-3 rounded-full bg-green-500 border border-green-700"></div>
							</div>
							<div class="hidden sm:flex items-center gap-2 bg-stone-800 brutalist-border px-3 py-1 ml-2">
								<span class="material-symbols-outlined text-stone-500 text-sm" id="url-icon">description</span>
								<span class="text-[11px] font-mono text-stone-400 truncate max-w-xs" id="url-text">ISM Primer JAN 2026.pdf</span>
							</div>
						</div>
						<div class="flex items-center gap-2">
							<a
								href="/ism-primer.pdf"
								download
								class="text-stone-500 hover:text-white transition-colors no-underline"
								title="Download PDF"
							>
								<span class="material-symbols-outlined text-lg">download</span>
							</a>
							<a
								id="external-link"
								href={links.prototypeUrl}
								target="_blank"
								rel="noopener noreferrer"
								class="text-stone-500 hover:text-white transition-colors no-underline"
								title="Open in Google Drive"
							>
								<span class="material-symbols-outlined text-lg">open_in_new</span>
							</a>
						</div>
					</div>
					<!-- Monitor Tabs -->
					<div class="flex bg-stone-950 border-b-2 border-black overflow-x-auto no-scrollbar">
						<button data-tab="prototype" data-src={previewUrl} data-url="ISM Primer JAN 2026.pdf" data-icon="description" class="monitor-tab flex items-center gap-1 px-2 sm:px-4 py-2 text-[9px] sm:text-[10px] font-black uppercase tracking-wider sm:tracking-widest text-white bg-stone-800 border-r border-stone-700 shrink-0 transition-colors">
							<span class="material-symbols-outlined text-sm hidden sm:inline">description</span>
							Document
						</button>
						<button data-tab="feedback" data-src={links.feedbackUrl || '#'} data-url="feedback-form" data-icon="rate_review" class="monitor-tab flex items-center gap-1 px-2 sm:px-4 py-2 text-[9px] sm:text-[10px] font-black uppercase tracking-wider sm:tracking-widest text-stone-500 hover:text-stone-300 border-r border-stone-700 shrink-0 transition-colors">
							<span class="material-symbols-outlined text-sm hidden sm:inline">rate_review</span>
							Feedback
						</button>
						<button data-tab="slides" data-src={links.slidesUrl || '#'} data-url="slides" data-icon="slideshow" class="monitor-tab flex items-center gap-1 px-2 sm:px-4 py-2 text-[9px] sm:text-[10px] font-black uppercase tracking-wider sm:tracking-widest text-stone-500 hover:text-stone-300 border-r border-stone-700 shrink-0 transition-colors">
							<span class="material-symbols-outlined text-sm hidden sm:inline">slideshow</span>
							Slides
						</button>
						<button data-tab="video" data-src={links.videoUrl || '#'} data-url="video" data-icon="play_circle" class="monitor-tab flex items-center gap-1 px-2 sm:px-4 py-2 text-[9px] sm:text-[10px] font-black uppercase tracking-wider sm:tracking-widest text-stone-500 hover:text-stone-300 shrink-0 transition-colors">
							<span class="material-symbols-outlined text-sm hidden sm:inline">play_circle</span>
							Video
						</button>
					</div>
					<!-- iframe Content -->
					<iframe
						id="monitor-frame"
						src={previewUrl}
						width="100%"
						style="height: 80vh; min-height: 500px;"
						allow="autoplay"
						class="border-0 block bg-white"
					></iframe>
				</div>

				<!-- Bottom CTA -->
				<div class="mt-6 flex flex-col sm:flex-row items-center justify-between gap-4">
					<a href="/" class="flex items-center gap-2 font-black uppercase tracking-widest text-sm hover:text-primary transition-colors no-underline text-inherit">
						Back to Feed
					</a>
					<a
						href={links.prototypeUrl}
						target="_blank"
						rel="noopener noreferrer"
						class="flex items-center gap-2 font-black uppercase tracking-widest text-sm text-primary hover:underline no-underline"
					>
						<span class="material-symbols-outlined">comment</span>
						Open in Drive to Comment
						<span class="material-symbols-outlined text-base">open_in_new</span>
					</a>
				</div>

			</main>

			<!-- Footer -->
			<footer class="bg-black text-white py-12 px-6 border-t-4 border-accent-blue mt-auto">
				<div class="max-w-[1440px] mx-auto flex flex-col md:flex-row justify-between items-start gap-12 text-left">
					<div class="max-w-xs">
						<h2 class="text-2xl font-[900] tracking-tighter uppercase italic mb-1">Frontier Labs</h2><p class="text-[9px] font-black uppercase tracking-[0.15em] text-stone-500 ml-[2px] mb-4">Experimental Division</p>
						<p class="text-stone-400 text-sm font-medium">Innovating the mobilization journey for International Student Ministry through cultural engagement tools and digital-first frameworks.</p>
					</div>
					<div class="grid grid-cols-2 sm:grid-cols-3 gap-12">
						<div class="flex flex-col gap-3">
							<p class="text-xs font-black uppercase text-primary tracking-widest">Social</p>
							<del class="text-sm font-bold text-stone-500">GitHub</del>
							<del class="text-sm font-bold text-stone-500">Twitter</del>
							<del class="text-sm font-bold text-stone-500">Discord</del>
						</div>
						<div class="flex flex-col gap-3">
							<p class="text-xs font-black uppercase text-primary tracking-widest">Legal</p>
							<a class="text-sm font-bold hover:text-stone-300 transition-colors" href="#">Privacy</a>
							<a class="text-sm font-bold hover:text-stone-300 transition-colors" href="#">Terms</a>
							<a class="text-sm font-bold hover:text-stone-300 transition-colors" href="#">License</a>
						</div>
						<div class="flex flex-col gap-3">
							<p class="text-xs font-black uppercase text-primary tracking-widest">Terminal</p>
							<p class="text-[10px] font-mono text-stone-500">System: Stable</p>
							<p class="text-[10px] font-mono text-stone-500">Nodes: 128 Active</p>
						</div>
					</div>
				</div>
				<div class="max-w-[1440px] mx-auto mt-12 pt-8 border-t border-stone-800 text-center md:text-left">
					<p class="text-[10px] font-black uppercase tracking-widest text-stone-600">&copy; 2025 Frontier Labs Experimental Division. All rights reserved.</p>
				</div>
			</footer>

		</div>
	<script>
		const tabs = document.querySelectorAll('.monitor-tab');
		const frame = document.getElementById('monitor-frame');
		const urlText = document.getElementById('url-text');
		const urlIcon = document.getElementById('url-icon');
		const extLink = document.getElementById('external-link');

		tabs.forEach(tab => {
			tab.addEventListener('click', () => {
				tabs.forEach(t => {
					t.classList.remove('bg-stone-800', 'text-white');
					t.classList.add('text-stone-500');
				});
				tab.classList.add('bg-stone-800', 'text-white');
				tab.classList.remove('text-stone-500');

				const rawSrc = tab.getAttribute('data-src');
				// Convert Google Drive sharing URLs to embeddable preview URLs
				const src = rawSrc ? rawSrc.replace(/\/view(\?[^#]*)?$/, '/preview') : rawSrc;
				if (src && src !== '#') {
					frame.src = src;
					extLink.href = rawSrc || src;
				}
				urlText.textContent = tab.getAttribute('data-url');
				urlIcon.textContent = tab.getAttribute('data-icon');
			});
		});
	</script>
	</body>
</html>
